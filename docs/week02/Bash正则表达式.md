# Bash正则表达式

grep语法：

``` Bash
grep [参数] 模式 [文件]
```

- `-c` 只打印匹配的行数
- `-i` 忽略大小写
- `-n` 输出的同时打印行号
- `-v` 反选，输出不匹配的行的内容
- `-r` 递归匹配查找
- `-R` 递归匹配查找，但会遍历所有符号链接
- `-A n` 除了列出匹配行之外，还列出后面n行
- `-B n` 除了列出匹配行之外，还列出前面n行

grep支持三种正则表达式引擎：

- `-G` POSIX基本正则表达式，BRE（默认）
- `-E` POSIX扩展正则表达式，ERE
- `-P` Perl正则表达式，PCRE

语法支持：

- `\d`, `\D` BRE和ERE均不支持
- `+`, `?`, `{n}`, `{n, m}` BRE不支持，ERE支持
- `|`, `()` BRE不支持，ERE支持
- `(?P<NAME>)` BRE和ERE均不支持
- `?` BRE和ERE均不支持非贪婪匹配

---

正则表达式：

- `.` 任意字符
- `\` 转义符
- `[...]` 指定的字符
- `[^...]` 不是指定的字符
- `\d`, `\D` 数字，非数字
- `\w`, `\W` 字母数字下划线，非字母数字下划线
- `\s`, `\S` 空白，非空白
- `{n}` 出现n次
- `{n,}`, `{,n}` 至少n次，至多n次
- `{n,m}` n至m次
- `*`, `+`, `?` 0+次，1+次，一次或零次
- `^`, `$` 开始， 结束
- `\b`, `\B` 单词边界，非单词边界
- `|` 或
- `()`, `(?P<NAME>)` 子表达式，分组

其它符号（BRE和ERE均支持）：

|符号|说明|
|---|---|
|`[:alnum:]`|`[0-9a-zA-Z]`|
|`[:alpha:]`|`[a-zA-Z]`|
|`[:lower:]`|`[a-z]`|
|`[:upper:]`|`[A-Z]`|
|`[:digit:]`|`[0-9]`|
|`[:blank:]`|空白字符和制表符，即`[ \t]`|
|`[:cntrl:]`|ASCII<32或127。控制键|
|`[:graph:]`|可打印字符，也就是数字字母和标点符号|
|`[:print:]`|可输出字符，也就是除了可打印字符，还包括空白字符|
|`[:punct:]`|标点符号|
|`[:space:]`|空白字符|
|`[:xdigit:]`|表示16进制的数字，即`[0-9a-fA-F]`|

---

sed：

- `-n` 安静模式，只打印受影响的行，默认打印全部内容
- `-e` 添加执行命令一次执行
- `-f 文件名` 指定执行文件中的命令
- `-r` 使用扩展正则表达式，默认为标准正则表达式
- `-i` 将直接修改输入文件内容，而不是打印到标准输出设备

行号选择：

- `n` 第n行
- `n,m` 从第n行到第m行
- `n~m` 从第n开始以m为步进的所有行
- `$` 最后一行

|命令|说明|
|---|---|
|`s`|行内替换|
|`c`|整行替换|
|`a`|插入到指定行的后面|
|`i`|插入到指定行的前面|
|`p`|打印，通常与`-n`参数配合使用|
|`d`|删除指定行|
|`y`|对应字符替换|

